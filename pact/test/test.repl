
(begin-tx)
(load "../root/fungible-v2.pact")
(load "fungible.repl")
(commit-tx)

(begin-tx)
(define-namespace 'test (sig-keyset) (sig-keyset))
(define-namespace 'swap (sig-keyset) (sig-keyset))
(load "../fungible-util.pact")
(load "ABC.pact")
(load "XYZ.pact")
(commit-tx)


(begin-tx)
(load "../root/coin.pact")
(test-capability (coin.COINBASE))
(use fungible-v2-test)
(coin.coinbase FUNDER_ACCT FUNDER_GUARD 10000.0)
(module coin-helper G
  (defcap G () true)
  (implements fungible-test-helper)
  (defun setup-rotate:bool (account:string old-key:string)
    (env-sigs [{"key": old-key,"caps":[(coin.ROTATE account)]}])
    true
  )
)
(commit-tx)

(fungible-v2-test.suite coin coin-helper "")

(begin-tx)
(use fungible-v2-test)
(test-capability (test.abc.CREDIT FUNDER_ACCT))
(test.abc.credit FUNDER_ACCT FUNDER_GUARD FUNDER_BALANCE)
(commit-tx)

(fungible-v2-test.suite test.abc fungible-test-helper-default "transfer-crosschain-tests")

(begin-tx)
(use fungible-v2-test)
(test-capability (test.xyz.CREDIT FUNDER_ACCT))
(test.xyz.credit FUNDER_ACCT FUNDER_GUARD FUNDER_BALANCE)
(commit-tx)

(fungible-v2-test.suite test.xyz fungible-test-helper-default "transfer-crosschain-tests")
